<template>
    <ul class="pagination" v-if="products.last_page > 1">
        <li :class="[ ((products.current_page == 1) ? 'disabled' : '') ]">
            <a :href="'?page='+products.current_page" @click.prevent="pageClicked(products.current_page-1)" aria-label="Previous" v-if="products.current_page != 1">
                <span aria-hidden="true">«</span>
            </a>
            <a v-else>
                <span  aria-hidden="true">«</span>
            </a>
        </li>
        <li v-for="pageNo in range(paginateLoop, numberOfPage)"
            :class="[ ((products.current_page == pageNo) ? 'active' : '') ]">
            <a :href="'?page='+pageNo" @click.prevent="pageClicked(pageNo)">{{ pageNo }}</a>
        </li>
        <li :class="[ ((products.current_page == products.last_page) ? 'disabled' : '') ]" >
            <a  :href="'?page='+products.current_page" @click.prevent="pageClicked(products.current_page+1)" aria-label="Next" v-if="products.current_page != products.last_page">
                <span aria-hidden="true">»</span>
            </a>
            <a v-else>
                <span  aria-hidden="true">»</span>
            </a>
        </li>
    </ul>
</template>

<script>
    export default {
        props: {
            products: {
                required: true,
                type: Array
            },
            midSize: {
                required: false,
                type: Number,
                default: 5
            }
        },

        data(){
            return {

            };
        },

        methods: {
            range(start, count) {
                return Array.apply(0, Array(count))
                    .map(function (element, index){
                        return index + start;
                    });
            },
            pageClicked(pageNo){
                this.$emit('clicked', pageNo);
            },
        },

        computed: {
            paginateLoop(){
                let results = this.products;
                if(results.last_page > this.midSize){
                    if((results.last_page - ((this.midSize - 1) / 2) ) <= results.current_page){
                        return results.last_page - (this.midSize - 1);
                    }

                    if( results.current_page > (((this.midSize - 1) / 2) + 1) ){
                        return results.current_page - ((this.midSize - 1) / 2);
                    }
                }
                return 1;
            },

            numberOfPage(){
                let results = this.products;
                if(results.last_page < this.midSize){
                    return results.last_page;
                }else{
                    return this.midSize;
                }
            }
        },
    };
</script>
